import{_ as S,Q as N,a as c,b as U,C as B,t as I,f as L}from"./_plugin-vue_export-helper-DtywERE2.js";import{b as f,p as M,Y as h,c as j,o as A,w as s,d as R,f as D,a as t,a3 as T,l as r,a0 as g,t as v,ag as O,Q as $,e as b,j as w,ah as z,Z as G}from"./index-BQSgIXwL.js";import{u as Y,Q as Z}from"./task-store-BYIGfhtW.js";import{Q as F}from"./QPage-CZMNfo7v.js";import{u as H}from"./use-quasar-DpaBgToP.js";import"./QList-Buv9lwN8.js";import"./QLinearProgress-ZcHCRENF.js";import"./format-E9ViLCS2.js";const J={__name:"TasksPage",setup(K){const n=Y(),k=R(),y=H(),V=[{name:"title",label:"Title",field:"title",sortable:!0,align:"center"},{name:"description",label:"Description",field:"description",align:"center"},{name:"status",label:"Status",field:"status",sortable:!0,align:"center"},{name:"dueDate",label:"Due Date",field:"dueDate",sortable:!0,align:"center"},{name:"actions",label:"Actions",field:"actions",align:"center"}],i=f({page:1,rowsPerPage:10,rowsNumber:0}),u=async()=>{const o=i.value.page-1,a=i.value.rowsPerPage<=0?1e3:i.value.rowsPerPage;await n.fetchTasks(o,a),i.value.rowsNumber=n.totalElements},P=async o=>{i.value.page=o.pagination.page,i.value.rowsPerPage=o.pagination.rowsPerPage,await u()},x=M(()=>n.allTasks),Q=(o,a=15)=>o?o.split(" ").map((d,m)=>(m+1)%a===0?d+`
`:d).join(" "):"",C=(o,a=6)=>o?o.split(" ").map((d,m)=>(m+1)%a===0?d+`
`:d).join(" "):"",p=f(!1),l=f({}),q=o=>{l.value={...o},l.value.dueDate&&(l.value.dueDateTime=I(l.value.dueDate)),p.value=!0},_=async()=>{if(new Date(l.value.dueDateTime)<new Date){y.notify({type:"negative",message:"Due date cannot be in the past"});return}const a={title:l.value.title,description:l.value.description,status:l.value.status,dueDate:L(l.value.dueDateTime)};await n.updateTask(l.value.id,a),p.value=!1,await u()},E=()=>k.push("/dashboard/tasks/add");return h(u),(o,a)=>(A(),j(F,{class:"q-pa-md"},{default:s(()=>[a[7]||(a[7]=D("div",{class:"text-h5 q-mb-md"},"My Tasks",-1)),t(N,{rows:x.value,columns:V,"row-key":"id",flat:"",bordered:"",title:"Task List",pagination:i.value,"onUpdate:pagination":a[0]||(a[0]=e=>i.value=e),loading:T(n).loading,onRequest:P},{"body-cell-title":s(e=>[t(c,{props:e,style:{"white-space":"pre-line","text-align":"center","max-width":"300px"}},{default:s(()=>[g(v(C(e.row.title)),1)]),_:2},1032,["props"])]),"body-cell-description":s(e=>[t(c,{props:e,style:{"white-space":"pre-line","text-align":"left","max-width":"500px"}},{default:s(()=>[g(v(Q(e.row.description)),1)]),_:2},1032,["props"])]),"body-cell-status":s(e=>[t(c,{props:e,align:"center"},{default:s(()=>[t(U,{color:e.row.status==="COMPLETED"?"green":"orange",class:"q-pa-sm text-white q-mx-sm",rounded:""},{default:s(()=>[g(v(e.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-actions":s(e=>[t(c,{align:"right"},{default:s(()=>[t(r,{dense:"",flat:"",color:"primary",icon:"edit",onClick:d=>q(e.row)},null,8,["onClick"]),t(r,{dense:"",flat:"",color:"negative",icon:"delete",onClick:async()=>{await T(n).deleteTask(e.row.id),await u()}},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","pagination","loading"]),t(r,{label:"Add Task",color:"primary",class:"q-mt-md",onClick:E}),t(O,{modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=e=>p.value=e)},{default:s(()=>[t($,{style:{"min-width":"400px"}},{default:s(()=>[t(b,null,{default:s(()=>[...a[6]||(a[6]=[D("div",{class:"text-h6"},"Edit Task",-1)])]),_:1}),t(b,{class:"q-gutter-md"},{default:s(()=>[t(w,{modelValue:l.value.title,"onUpdate:modelValue":a[1]||(a[1]=e=>l.value.title=e),label:"Title",filled:""},null,8,["modelValue"]),t(w,{modelValue:l.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value.description=e),label:"Description",type:"textarea",filled:""},null,8,["modelValue"]),t(Z,{modelValue:l.value.status,"onUpdate:modelValue":a[3]||(a[3]=e=>l.value.status=e),options:["PENDING","COMPLETED"],label:"Status",filled:""},null,8,["modelValue"]),t(w,{modelValue:l.value.dueDateTime,"onUpdate:modelValue":a[4]||(a[4]=e=>l.value.dueDateTime=e),label:"Due Date & Time",type:"datetime-local",filled:"",required:""},null,8,["modelValue"])]),_:1}),t(z,{align:"right"},{default:s(()=>[G(t(r,{flat:"",label:"Cancel"},null,512),[[B]]),t(r,{color:"primary",label:"Save",onClick:_})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ie=S(J,[["__scopeId","data-v-f337bafc"]]);export{ie as default};
